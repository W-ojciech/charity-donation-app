{% extends "base.html" %}


{% block title %} Strona użytkownika {% endblock %}

{% block przekaz_dary %}
    <li>
    {% if user.is_authenticated %}
        <a href="/add-donation/" class="btn btn--without-border">Przekaż dary</a>
    {% else %}
        <a href="/login/" class="btn btn--without-border">Przekaż dary</a>
    {% endif %}
    </li>
{% endblock %}

{% block header-bg %} {% endblock %}
{% block extra_header %} {% endblock %}

{% block content %}
    <section id="steps" class="steps">
        <h2>User Page</h2>
        <div class="steps--container">
            <div class="steps--item">
                <h3>Email - username</h3>
                <p>{{ user.email }}</p>
            </div>

            <div class="steps--item">
                <h3>Account from</h3>
                <p>{{ user.date_joined }}</p>
            </div>

            <div class="steps--item">
                <h3>Admin permissions</h3>
                {% if user.is_superuser %}
                    <p>Yes</p>
                {% else %}
                    <p>No</p>
                {% endif %}
            </div>
        </div>

        <div class="steps--container" style="background-color: lightgray">
            <p style="font-size: 2.5em;">Lista przekazanych darów</p>
        </div>

        <div class="donations-div" id="user-donations">
            <div class="user-donations">
                <p><b>Ilość worków</b></p>
            </div>
            <div class="user-donations">
                <p><b>Wsparta organizacja</b></p>
            </div>
            <div class="user-donations">
                <p><b>Rodzaje darów</b></p>
            </div>
            <div class="user-donations">
                <p><b>Data odbioru</b></p>
            </div>
            <div class="user-donations">
                <p><b>Status</b></p>
            </div>
            <div style="clear: both;">
            </div>
        </div>

        <div class="donations-div">
            {% for donation in donations %}
                <div style="width: 100%; height: 80px;
                        background-color: #79aec8">
                    <div class="user-donations" {% if donation.taken_or_not %}
                         style="color: white;" {% endif %}>
                        <p>{{ donation.quantity }}</p>
                    </div>
                    <div class="user-donations" {% if donation.taken_or_not %}
                         style="color: white;" {% endif %}>
                        <p>{{ donation.institution.name }}</p>
                    </div>
                    <div class="user-donations" {% if donation.taken_or_not %}
                         style="color: white;" {% endif %}>
                        <p>{% for category in donation.categories.all %}
                            {{ category.name }},
                        {% endfor %}</p>
                    </div>
                    <div class="user-donations" {% if donation.taken_or_not %}
                         style="color: white;" {% endif %}>
                        <p>{{ donation.pick_up_date }}</p>
                    </div>
                    <div class="user-donations taken-or-not">
                        {% if donation.taken_or_not %}
                            <p>Odebrane</p>
                            <form action="" method="POST" id="status">
                                {% csrf_token %}
                                <input type="hidden" value="{{ donation.id }}"
                                       name="user-page-input"/>
                                <button name="change-status2"
                                        type="submit" onclick="document.getElementById('status').submit();"
                                        value="{{ donation.id }}"
                                        style="margin-right: auto; margin-left: auto;"
                                        id="donation-id">Anuluj odbiór
                                </button>
                            </form>
                        {% else %}
                            <p>Nie odebrane</p>
                            <form action="" method="POST" id="status">
                                {% csrf_token %}
                                <input type="hidden" value="{{ donation.id }}"
                                       name="user-page-input"/>
                                <button name="change-status2"
                                        type="submit" onclick="document.getElementById('status').submit();"
                                        value="{{ donation.id }}"
                                        style="margin-right: auto; margin-left: auto;"
                                        id="donation-id">Potwierdź odbiór
                                </button>
                            </form>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </section>
{% endblock %}